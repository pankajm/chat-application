<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
}

.topnav {
  overflow: hidden;
  background-color: #333;
  width: 80%;
}

.topnav a {
  float: left;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

.topnav a:hover {
  background-color: #ddd;
  color: black;
}

.topnav a.active {
  background-color: #4CAF50;
  color: white;
}

.userColumn {
  float:right;
  height:100%;
  width:20%;
  text-align:left;
}
</style>
</head>
<body>

<div class="topnav">
  <a class="active" href="/home">Home</a>
  <a href="/chat">Chat</a>
  <a href="/about">About</a>
</div>

<div style="padding-left:16px">
  <h2>This is Home Page</h2>
  <p>Some content..</p>
</div>
<div>
<ul class="userColumn" id="online_users">
  Online Users 
</ul>
</div>
<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
  $(function () {
    console.log('before');
    $( document ).ready(function() {
      console.log( "ready!" );
    });
    var socket = io();
    // $('form').submit(function(e) {
    //   e.preventDefault(); // prevents page reloading
    //   socket.emit('chat message', $('#m').val());
    //   $('#m').val('');
    //   return false;
    // });
    // socket.on('chat message', function(msg){
    //   $('#messages').append($('<li>').text(msg));
    // });
    socket.on('new user online', function(user){
      console.log('user online aa gaya');
      $('#online_users').append($('<li id='+user+'>').text(user));
    })
    socket.emit('page loads', localStorage.getItem('username'), 'home');

    socket.on('show all online users', function(users){
      users.forEach(user => {
          console.log(user);
          $('#online_users').append($('<li id='+user+'>').text(user));
      });
    })

    socket.on('user disconnected', function(user){
      console.log('user disconect ho gaya');
      // $('#online_users').filter(function() { return $.text([this]) === user; }).remove();
      console.log($('#'+user));
      $('#'+user).remove();
    })

  });
</script>


</body>
</html>